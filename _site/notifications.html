<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Shout to Me Android SDK</title>
  <meta name="description" content="The Shout to Me Android SDK Documentation provides information, reference, and examples of how to incorporate Shout to Me platform functionality into your An...">

  <link rel="stylesheet" href="/stm-sdk-android/assets/main.css">
  <link rel="canonical" href="/stm-sdk-android/notifications.html">
  <link rel="alternate" type="application/rss+xml" title="Shout to Me Android SDK" href="/stm-sdk-android/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/stm-sdk-android/">Shout to Me Android SDK</a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          <a class="page-link" href="/stm-sdk-android/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  <div style="width:100%">
    <div style="float:left;width:170px;margin-top:50px;margin-left: -170px;">
      <div>Android SDK</div>
      <ul style="margin-left:10px;list-style: none">
        <li><a href="/stm-sdk-android/">Home</a></li>
        <li><a href="getting-started">Getting Started</a>
          <ul>
            <li><a href="setup">Setup</a></li>
            <li><a href="sample-app">Sample App</a></li>
          </ul>
        </li>
        <li><a href="stm-service">StmService</a></li>
        <li><a href="create-shout">Create a Shout</a></li>
        <li><a href="notifications">Messages and Notifications</a></li>
        <li><a href="reference">Reference</a></li>

      </ul>
    </div>
    <div style="width:100%;">
      <h1 id="messages-and-notifications">Messages and Notifications</h1>

<p>The Shout to Me platform allows you to enable your app to receive communications sent from Shout to Meâ€™s Broadcaster
Application.  Messages and notifications are two separate concepts in the Shout to Me system.  A <strong>Message</strong> is text or
audio content that is sent to mobile users to convey a communication.  A <strong>Notification</strong> is the delivery mechanism used to transport a Message.</p>

<h2 id="messages">Messages</h2>
<p>The Message object represents a text or audio message that was sent from a broadcaster.  A
user may receive messages from more than one channel if the client app supports multiple channels.  Some messages have
audio associated with them. When they do, you can use the conversation ID to get access to the audio.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Message</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">()</span>

    <span class="kd">public</span> <span class="n">Channel</span> <span class="nf">getChannel</span><span class="o">()</span>

    <span class="c1">// The actual message text</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span>

    <span class="c1">// The name of the sender.  May be null if was sent via a channel-wide notification</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getSenderName</span><span class="o">()</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getSentDate</span><span class="o">()</span>

    <span class="c1">// A reference to a Shout to Me conversation.  May be null if message was not associated with a conversation</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getConversationId</span><span class="o">()</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="retrieving-messages">Retrieving messages</h3>

<p>A maximum of 1000 messages will be returned.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stmService</span><span class="o">.</span><span class="na">getMessages</span><span class="o">(</span><span class="k">new</span> <span class="n">Callback</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">StmResponse</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;&gt;</span> <span class="n">messagesResponse</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;</span> <span class="n">messageList</span> <span class="o">=</span> <span class="n">messagesResponse</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">StmError</span> <span class="n">stmError</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Could not retrieve message list</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
</div>

<h2 id="notifications">Notifications</h2>
<p>The Shout to Me SDK supports receiving push notifications from the Shout to Me platform.  The SDK will only handle
  notifications sent from the Shout to Me system.  There are a number of technologies used in receiving notifications,
  and consequently, there are a number of items that need to be wired up. The following high level steps occur in the
  notifications system:</p>

<ol>
  <li>A message is sent from the Shout to Me Broadcaster Application</li>
  <li>The message is delivered to the mobile app as a Google Cloud Messaging notification</li>
  <li>The Shout to Me SDK receives the notification and broadcasts a message</li>
  <li>A listener in the client app receives a broadcast and can take further action using the data</li>
</ol>

<p><img src="https://s3-us-west-2.amazonaws.com/sdk-public-images/android-notifications.png" alt="Notifications" /></p>

<h3 id="google-cloud-messaging">Google Cloud Messaging</h3>
<p>The Shout to Me system uses <a href="https://developers.google.com/cloud-messaging/">Google Cloud Messaging (GCM)</a> to send and receive messages. Add the following to your AndroidManifest.xml if you wish to receive notifications.  Be sure to set your own values for the string resource references.  Check with Shout to Me support for specific values to use.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;service</span>
    <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.GcmNotificationRegistrationIntentService"</span>
    <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.NotificationAppId"</span> <span class="na">android:value=</span><span class="s">"@string/notification_app_id"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/service&gt;</span>

<span class="c">&lt;!-- [START gcm_receiver] --&gt;</span>
<span class="nt">&lt;receiver</span>
    <span class="na">android:name=</span><span class="s">"com.google.android.gms.gcm.GcmReceiver"</span>
    <span class="na">android:exported=</span><span class="s">"true"</span>
    <span class="na">android:permission=</span><span class="s">"com.google.android.c2dm.permission.SEND"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.RECEIVE"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"me.shoutto.sdk"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/receiver&gt;</span>
<span class="c">&lt;!-- [END gcm_receiver] --&gt;</span>


<span class="c">&lt;!-- [START gcm_listener] --&gt;</span>
<span class="nt">&lt;service</span>
    <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.StmGcmListenerService"</span>
    <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.RECEIVE"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
<span class="c">&lt;!-- [END gcm_listener] --&gt;</span>


<span class="c">&lt;!-- [START instanceId_listener] --&gt;</span>
<span class="nt">&lt;service</span>
    <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.GcmInstanceIDListenerService"</span>
    <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.gms.iid.InstanceID"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
<span class="c">&lt;!-- [END instanceId_listener] --&gt;</span>
</code></pre>
</div>

<h3 id="geofencing">Geofencing</h3>
<p>Location based notifications will be created as <a href="https://developers.google.com/android/reference/com/google/android/gms/location/Geofence">geofences</a> in the Shout to Me SDK.  Add this to your AndroidManifest.xml to allow the SDK to listen for geofence events:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.GeofenceTransitionsIntentService"</span> <span class="nt">/&gt;</span>
</code></pre>
</div>

<p><strong>Note:</strong> Please contact Shout to Me support if you are already using geofences within your application.</p>

<h3 id="shout-to-me-broadcasts">Shout to Me Broadcasts</h3>
<p>The Shout to Me SDK uses a standard Android broadcast to send the processed message data to client apps.  Add the following to your AndroidManifest.xml to listen for these broadcasts.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;receiver</span>
    <span class="na">android:name=</span><span class="s">".StmNotificationReceiver"</span>
    <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"me.shoutto.sdk.EVENT_MESSAGE_NOTIFICATION_RECEIVED"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/receiver&gt;</span>
</code></pre>
</div>

<p>Of course, you will need to supply your own listener class. In this example, it is called StmNotificationReceiver.</p>

<p>The broadcast receiver class should include something similar to the following to retrieve the broadcast data:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Bundle</span> <span class="n">data</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getExtras</span><span class="o">();</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MessageNotificationIntentWrapper</span><span class="o">.</span><span class="na">EXTRA_NOTIFICATION_BODY</span><span class="o">);</span>
    <span class="n">channelId</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MessageNotificationIntentWrapper</span><span class="o">.</span><span class="na">EXTRA_CHANNEL_ID</span><span class="o">);</span>
    <span class="n">channelImageUrl</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MessageNotificationIntentWrapper</span><span class="o">.</span><span class="na">EXTRA_CHANNEL_IMAGE_URL</span><span class="o">);</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MessageNotificationIntentWrapper</span><span class="o">.</span><span class="na">EXTRA_NOTIFICATION_TITLE</span><span class="o">);</span>
    <span class="n">type</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MessageNotificationIntentWrapper</span><span class="o">.</span><span class="na">EXTRA_NOTIFICATION_TYPE</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

    </div>
  </div>

</div>
      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Shout to Me Android SDK</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Shout to Me Android SDK
            
            </li>
            
            <li><a href="mailto:support@shoutto.me">support@shoutto.me</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/ShoutToMe"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">ShoutToMe</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/shout_to_me"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">shout_to_me</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>The Shout to Me Android SDK Documentation provides information, reference, and examples of how to incorporate Shout to Me platform functionality into your Android app.  
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
